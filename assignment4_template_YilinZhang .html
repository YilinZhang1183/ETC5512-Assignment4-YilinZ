<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yilin Zhang">

<title>Can music improve mental health?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="assignment4_template_YilinZhang _files/libs/clipboard/clipboard.min.js"></script>
<script src="assignment4_template_YilinZhang _files/libs/quarto-html/quarto.js"></script>
<script src="assignment4_template_YilinZhang _files/libs/quarto-html/popper.min.js"></script>
<script src="assignment4_template_YilinZhang _files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assignment4_template_YilinZhang _files/libs/quarto-html/anchor.min.js"></script>
<link href="assignment4_template_YilinZhang _files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assignment4_template_YilinZhang _files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assignment4_template_YilinZhang _files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assignment4_template_YilinZhang _files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assignment4_template_YilinZhang _files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Can music improve mental health?</h1>
<p class="subtitle lead">Assignment 4 ETC5512</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yilin Zhang </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Data and Documenting</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Blog post</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Behind the Scenes</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<section id="research-question" class="level3">
<h3 class="anchored" data-anchor-id="research-question">Research Question</h3>
<p>Can music help improve mental health, and if so, do different music genres have different impacts on specific mental health issues?</p>
<ul>
<li><p>Whether frequent listening to certain genres if associated with lower anxiety, depression, insomnia, or OCD levels.</p></li>
<li><p>Whether certain genres are more effective for specific mental health concerns.</p></li>
<li><p>Whether listening conditions, such as listening while working or total hours per day might affect the mental health outcomes of music.</p></li>
</ul>
<p>These questions aim to provide insights into how music could be a personalized, feasible tool to improve emotional well-being.</p>
</section>
<section id="data-set-and-suitability" class="level3">
<h3 class="anchored" data-anchor-id="data-set-and-suitability">Data Set and Suitability</h3>
<p>In order to solve my doubts, I uses the “Music &amp; Mental Health Survey” data set, which is a non-probability public sample from a Google Form survey on Kaggle by Catherine Rasgaitis. This data set contains 736 public questionnaire surveys from Google.</p>
<p>Thus this data set is highly suitable as the foundation for conducting research.</p>
<ul>
<li><p>Listening preference: frequency of listening to specific genres, Music style preference, Primary streaming platform.</p></li>
<li><p>Mental health indicators: self-reported anxiety, depression, insomnia, and OCD.</p></li>
<li><p>Listening habits: whether respondent listen to music while work, play an instrument regularly, how many hours per day they listen and so on.</p></li>
</ul>
<p>These data is helpful for exploring the positive impact of different genres of music on mental health.</p>
</section>
<section id="data-description" class="level3">
<h3 class="anchored" data-anchor-id="data-description">Data Description</h3>
<ul>
<li><p>Data set name: Music &amp; Mental Health Survey</p></li>
<li><p>Source: [Kaggle Dataset](<a href="https://www.kaggle.com/datasets/catherinerasgaitis/mxmh-survey-results" class="uri">https://www.kaggle.com/datasets/catherinerasgaitis/mxmh-survey-results</a>)</p></li>
</ul>
</section>
<section id="data-dictionary-music-mental-health-survey" class="level3">
<h3 class="anchored" data-anchor-id="data-dictionary-music-mental-health-survey">Data Dictionary – Music &amp; Mental Health Survey</h3>
<pre><code>| Variable | Description |
|------------------|------------------------------------------------------|
| age | Age of the respondent (numeric) |
| hours_per_day | Number of hours spent listening to music per day (numeric) |
| while_working | Whether the respondent listens to music while working (Yes/No) |
| anxiety | Self-reported anxiety level (0–10 scale) |
| depression | Self-reported depression level (0–10 scale) |
| insomnia | Self-reported insomnia level (0–10 scale) |
| ocd | Self-reported OCD level (0–10 scale) |
| frequency_pop | Frequency of listening to Pop music (0–3; 0 = Never, 3 = Very frequently) |
| frequency_classical | Frequency of listening to Classical music (same scale) |
| frequency_rock | Frequency of listening to Rock music (same scale) |
| frequency_video_game | Frequency of listening to Video Game Music (same scale) |
| frequency_country | Frequency of listening to Country music (same scale) |
| frequency_Edm | Frequency of listening to EDM music (same scale) |
| frequency_K_pop | Frequency of listening to K-pop (same scale) |
| frequency_R&amp;B | Frequency of listening to R&amp;B (same scale) |
| frequency_Gospel | Frequency of listening to Gospel music (same scale) |
| frequency_rap | Frequency of listening to Rap music (same scale) |
| frequency_jazz | Frequency of listening to Jazz (same scale) |
| frequency_latin | Frequency of listening to Latin music (same scale) |
| frequency_folk | Frequency of listening to Folk music (same scale) |
| frequency_hip_hop | Frequency of listening to Hip Hop music (same scale) |
| frequency_lofi | Frequency of listening to Lo-fi music (same scale) |</code></pre>
</section>
<section id="ethical-considerations" class="level3">
<h3 class="anchored" data-anchor-id="ethical-considerations">Ethical Considerations</h3>
<p>This data set is composed of self-evaluation questionnaires publicly collected by Google, which include selection bias, subjective judgment and non-standardized responses. Personal identity information is not included in the dataset, and the possibility of re-identification due to privacy leakage is low. However, mental health data is sensitive private information. Caution should be exercised when analyzing it. The results should only be used as a reference and should not be over-interpreted.</p>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data Preparation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># reading data</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>music_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/mxmh_survey_results.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 736 Columns: 33
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (26): Timestamp, Primary streaming service, While working, Instrumentali...
dbl  (7): Age, Hours per day, BPM, Anxiety, Depression, Insomnia, OCD

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transfrom frequency text into numerical value</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>freq_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Never"</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">"Rarely"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Sometimes"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Very frequently"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create and name new columns</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>music <span class="ot">&lt;-</span> music_raw <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"frequency_"</span>), <span class="sc">~</span> freq_map[.x], <span class="at">.names =</span> <span class="st">"num_{.col}"</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># only keep the records which are not missing</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>music_clean <span class="ot">&lt;-</span> music <span class="sc">|&gt;</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(anxiety), <span class="sc">!</span><span class="fu">is.na</span>(depression), <span class="sc">!</span><span class="fu">is.na</span>(insomnia), <span class="sc">!</span><span class="fu">is.na</span>(ocd))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(music_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 736
Columns: 49
$ timestamp                      &lt;chr&gt; "8/27/2022 19:29:02", "8/27/2022 19:57:…
$ age                            &lt;dbl&gt; 18, 63, 18, 61, 18, 18, 18, 21, 19, 18,…
$ primary_streaming_service      &lt;chr&gt; "Spotify", "Pandora", "Spotify", "YouTu…
$ hours_per_day                  &lt;dbl&gt; 3.0, 1.5, 4.0, 2.5, 4.0, 5.0, 3.0, 1.0,…
$ while_working                  &lt;chr&gt; "Yes", "Yes", "No", "Yes", "Yes", "Yes"…
$ instrumentalist                &lt;chr&gt; "Yes", "No", "No", "No", "No", "Yes", "…
$ composer                       &lt;chr&gt; "Yes", "No", "No", "Yes", "No", "Yes", …
$ fav_genre                      &lt;chr&gt; "Latin", "Rock", "Video game music", "J…
$ exploratory                    &lt;chr&gt; "Yes", "Yes", "No", "Yes", "Yes", "Yes"…
$ foreign_languages              &lt;chr&gt; "Yes", "No", "Yes", "Yes", "No", "Yes",…
$ bpm                            &lt;dbl&gt; 156, 119, 132, 84, 107, 86, 66, 95, 94,…
$ frequency_classical            &lt;chr&gt; "Rarely", "Sometimes", "Never", "Someti…
$ frequency_country              &lt;chr&gt; "Never", "Never", "Never", "Never", "Ne…
$ frequency_edm                  &lt;chr&gt; "Rarely", "Never", "Very frequently", "…
$ frequency_folk                 &lt;chr&gt; "Never", "Rarely", "Never", "Rarely", "…
$ frequency_gospel               &lt;chr&gt; "Never", "Sometimes", "Never", "Sometim…
$ frequency_hip_hop              &lt;chr&gt; "Sometimes", "Rarely", "Rarely", "Never…
$ frequency_jazz                 &lt;chr&gt; "Never", "Very frequently", "Rarely", "…
$ frequency_k_pop                &lt;chr&gt; "Very frequently", "Rarely", "Very freq…
$ frequency_latin                &lt;chr&gt; "Very frequently", "Sometimes", "Never"…
$ frequency_lofi                 &lt;chr&gt; "Rarely", "Rarely", "Sometimes", "Somet…
$ frequency_metal                &lt;chr&gt; "Never", "Never", "Sometimes", "Never",…
$ frequency_pop                  &lt;chr&gt; "Very frequently", "Sometimes", "Rarely…
$ frequency_r_b                  &lt;chr&gt; "Sometimes", "Sometimes", "Never", "Som…
$ frequency_rap                  &lt;chr&gt; "Very frequently", "Rarely", "Rarely", …
$ frequency_rock                 &lt;chr&gt; "Never", "Very frequently", "Rarely", "…
$ frequency_video_game_music     &lt;chr&gt; "Sometimes", "Rarely", "Very frequently…
$ anxiety                        &lt;dbl&gt; 3, 7, 7, 9, 7, 8, 4, 5, 2, 2, 7, 1, 9, …
$ depression                     &lt;dbl&gt; 0, 2, 7, 7, 2, 8, 8, 3, 0, 2, 7, 0, 3, …
$ insomnia                       &lt;dbl&gt; 1, 2, 10, 3, 5, 7, 6, 5, 0, 5, 4, 0, 2,…
$ ocd                            &lt;dbl&gt; 0, 1, 2, 3, 9, 7, 0, 3, 0, 1, 7, 1, 7, …
$ music_effects                  &lt;chr&gt; NA, NA, "No effect", "Improve", "Improv…
$ permissions                    &lt;chr&gt; "I understand.", "I understand.", "I un…
$ num_frequency_classical        &lt;dbl&gt; 1, 2, 0, 2, 0, 1, 2, 0, 0, 1, 0, 1, 1, …
$ num_frequency_country          &lt;dbl&gt; 0, 0, 0, 0, 0, 2, 0, 0, 3, 1, 3, 0, 0, …
$ num_frequency_edm              &lt;dbl&gt; 1, 0, 3, 0, 1, 0, 1, 1, 0, 1, 0, 3, 1, …
$ num_frequency_folk             &lt;dbl&gt; 0, 1, 0, 1, 0, 0, 2, 0, 2, 1, 0, 0, 0, …
$ num_frequency_gospel           &lt;dbl&gt; 0, 2, 0, 2, 1, 0, 1, 0, 0, 2, 0, 0, 0, …
$ num_frequency_hip_hop          &lt;dbl&gt; 2, 1, 1, 0, 3, 2, 1, 3, 0, 1, 0, 2, 3, …
$ num_frequency_jazz             &lt;dbl&gt; 0, 3, 1, 3, 0, 3, 2, 1, 0, 1, 0, 1, 0, …
$ num_frequency_k_pop            &lt;dbl&gt; 3, 1, 3, 2, 3, 3, 0, 3, 0, 0, 0, 1, 2, …
$ num_frequency_latin            &lt;dbl&gt; 3, 2, 0, 3, 2, 1, 1, 0, 0, 1, 0, 1, 0, …
$ num_frequency_lofi             &lt;dbl&gt; 1, 1, 2, 2, 2, 3, 1, 2, 0, 1, 0, 1, 3, …
$ num_frequency_metal            &lt;dbl&gt; 0, 0, 2, 0, 0, 1, 1, 0, 3, 0, 0, 0, 0, …
$ num_frequency_pop              &lt;dbl&gt; 3, 2, 1, 2, 2, 3, 1, 2, 0, 2, 1, 1, 2, …
$ num_frequency_r_b              &lt;dbl&gt; 2, 2, 0, 2, 3, 3, 1, 2, 0, 2, 1, 1, 2, …
$ num_frequency_rap              &lt;dbl&gt; 3, 1, 1, 0, 3, 3, 0, 1, 0, 1, 0, 2, 1, …
$ num_frequency_rock             &lt;dbl&gt; 0, 3, 1, 0, 0, 3, 0, 0, 3, 2, 1, 1, 1, …
$ num_frequency_video_game_music &lt;dbl&gt; 2, 1, 3, 0, 1, 0, 2, 1, 0, 2, 0, 1, 0, …</code></pre>
</div>
</div>
<!-- Task 2 Tab: Writing your blogpost -->
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="motivation" class="level3">
<h3 class="anchored" data-anchor-id="motivation">Motivation</h3>
<p>I have always been a person who loves to appreciate music very much and is willing to try listening to various different music styles. When studying, I often complete tasks while listening to classical music, which makes me more concentrated. When taking a walk in the evening, jazz music makes me feel that the whole world becomes romantic. When I’m feeling down, country music can soothe my negative emotions. Music has almost become an indispensable part of my life.</p>
<p>It is precisely because of this close connection that I began to wonder: Do others also regulate their emotions through music? Do different music styles have different effects on improving mental health? These questions have become the starting point of my data analysis this time.</p>
</section>
<section id="does-listening-to-certain-genres-help-reduce-anxiety" class="level3">
<h3 class="anchored" data-anchor-id="does-listening-to-certain-genres-help-reduce-anxiety">1. Does listening to certain genres help reduce anxiety?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>music_long <span class="ot">&lt;-</span> music_clean <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(anxiety, <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"genre"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"frequency"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_remove</span>(genre, <span class="st">"num_frequency_"</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_replace_all</span>(genre, <span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span> <span class="fu">str_to_title</span>()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> music_long <span class="sc">|&gt;</span> <span class="fu">filter</span>(frequency <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(genre, anxiety, median), <span class="at">y =</span> anxiety)) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Anxiety levels among frequent listeners of different music genres"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Music Genre"</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Anxiety Score (0–10)"</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_YilinZhang-_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This box plot shows the distribution of self-reported anxiety levels among respondents who frequently listen to each type of music, that is, those concentrated on “sometimes” and “very frequently”. We observed that Music genres such as “Country”, “Classical” ,“Edm” and so on have a positive moderating effect on anxiety, while music genres such as “Pop”, “Rock” and “Video Game Music” are highly likely to make the subjects feel more anxious. This indicates that music genres with softer melodies, slower rhythms and light drumbeats are more effective in reducing anxiety.</p>
</section>
<section id="are-some-genres-more-helpful-for-other-mental-health-issues" class="level3">
<h3 class="anchored" data-anchor-id="are-some-genres-more-helpful-for-other-mental-health-issues">2. Are some genres more helpful for other mental health issues?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>music_long_dep <span class="ot">&lt;-</span> music_clean <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(depression, <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"genre"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"frequency"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_remove</span>(genre, <span class="st">"num_frequency_"</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_replace_all</span>(genre, <span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span> <span class="fu">str_to_title</span>()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(frequency <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(music_long_dep, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(genre, depression, median), <span class="at">y =</span> depression)) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"plum"</span>) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Depression levels among frequent listeners of different music genres"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Music Genre"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Depression Score (0–10)"</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_YilinZhang-_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the above chart, we can see that listeners who tend to listen to Classical, Gospel or Country music have relatively lower median scores for self-evaluation of depression tendencies, indicating that these types of music may have the potential to soothe depressive moods, or it could be that those who prefer such soft music are less likely to suffer from depression. On the contrary, listeners of Rock, Rap and Video Game Music have higher levels of depression, suggesting that these music genres may be insufficient in regulating emotions, or that their audience groups themselves have a higher risk of depression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>music_long_insomnia <span class="ot">&lt;-</span> music_clean <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(insomnia, <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"genre"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"frequency"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_remove</span>(genre, <span class="st">"num_frequency_"</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_replace_all</span>(genre, <span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span> <span class="fu">str_to_title</span>()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(frequency <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(music_long_insomnia, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(genre, insomnia, median), <span class="at">y =</span> insomnia)) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Insomnia levels among frequent listeners of different music genres"</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Music Genre"</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Insomnia Score (0–10)"</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_YilinZhang-_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This chart clearly compares the distribution differences in the degree of insomnia among groups that often listen to different music styles. We can see that listeners who tend to listen to Folk, Gospel or Country music have a relatively lower median score of self-evaluation of insomnia tendency, and the box is shorter, indicating that the feelings of most subjects are relatively concentrated. It indicates that these types of music may have a soothing effect on emotions, or that such listeners have less pressure to fall asleep. On the contrary, listeners of Jazz, EDM and Mental are more prone to insomnia problems, and the box is longer. The sleep conditions of the subjects are more polarized, and the effect of such music in regulating insomnia is relatively low.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>music_long_ocd <span class="ot">&lt;-</span> music_clean <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ocd, <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"genre"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"frequency"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_remove</span>(genre, <span class="st">"num_frequency_"</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_replace_all</span>(genre, <span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span> <span class="fu">str_to_title</span>()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(frequency <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(music_long_ocd, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(genre, ocd, median), <span class="at">y =</span> ocd)) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"salmon"</span>) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"OCD levels among frequent listeners of different music genres"</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Music Genre"</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"OCD Score (0–10)"</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_YilinZhang-_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This chart shows the self-evaluation scores of subjects who frequently enjoy different music styles regarding the degree of obsessive-compulsive disorder. The median OCD scores of the subjects in most styles are concentrated around 2 points, indicating that the majority of the subjects self-evaluate the degree of obsessive-compulsive disorder as not high. Among them, the lowest median was Gospel and Jazz, and the differences in the other music styles were relatively small. ### 3. Dose time spent listening to music affect mental health?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>music_clean <span class="ot">&lt;-</span> music_clean <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hour_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    hours_per_day <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;1h"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    hours_per_day <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"1–2h"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    hours_per_day <span class="sc">&lt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"2–4h"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"4+h"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(music_clean, <span class="fu">aes</span>(<span class="at">x =</span> hours_per_day, <span class="at">y =</span> anxiety)) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between listening time and anxiety"</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hours Listening to Music per Day"</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Anxiety Score (0–10)"</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_YilinZhang-_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot combines a scatter of individual data points with a LOSS-smoothed curve to show the relationship between daily time spent listening to music relates to self-evaluation. Among them, the duration of listening to songs was 0 to 3 hours, and the self-anxiety score was between 5 and 6 points. The curve slightly rose, indicating that the average anxiety score of the subjects who never listened or spent less than 3 hours a day would increase slightly with the market. Then, it was observed that the changing trend of the anxiety scores of the audience for 3 to 10 hours was stable, remaining at around 5.5 points with few fluctuations. Finally, let’s look at the situation of listeners who listened to music for more than 10 hours. The blue line slightly decreased, indicating that the average anxiety score of the subjects who listened to music for an extremely long time every day might be slightly lower. However, this range has a smaller sample size and a wider confidence interval, making it difficult to draw a conclusion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>music_long_health <span class="ot">&lt;-</span> music_clean <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(while_working, anxiety, depression, insomnia, ocd) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> anxiety<span class="sc">:</span>ocd, <span class="at">names_to =</span> <span class="st">"condition"</span>, <span class="at">values_to =</span> <span class="st">"score"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(music_long_health, <span class="fu">aes</span>(<span class="at">x =</span> while_working, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>condition, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mental health scores by listening while working"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Listen While Working?"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Score"</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_YilinZhang-_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>Anxiety group, the music listeners (Yes) : The upper middle part of the curve is wider, indicating that more people consider themselves to have high (6-8 points) or even extremely high (9-10 points) anxiety symptoms. Those who don’t listen (No) : The distribution is relatively more likely to concentrate in the middle and lower reaches (2-6 points), and there are fewer people in the high range (8-10 points), which means a lower level of anxiety.</li>
<li>depression, Yes group has a higher density between 5 and 8 points; Group No has a higher proportion in the medium and low score range (2-5 points).</li>
<li>The Yes group for insomnia has a very wide range from 6 to 9, indicating that a considerable number of people who like to listen to music at work have a relatively high self-rated score. Group No, on the other hand, is more concentrated between 1 and 5 points.</li>
<li>Obsessive-compulsive Tendencies (OCD) : The density at the top (8-10 points) of the Yes group was significantly higher than that of the No group, while the No group was almost concentrated in the low scores (0-3). It is concluded that people who listen to music while working may have more severe obsessive-compulsive symptoms.</li>
<li>NA group: The sample size was small and the distribution was irregular, which could be ignored.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>music_heat <span class="ot">&lt;-</span> music_clean <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(anxiety, depression, insomnia, ocd, <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"num_frequency_"</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"genre"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"frequency"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_remove</span>(genre, <span class="st">"num_frequency_"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">genre =</span> <span class="fu">str_replace_all</span>(genre, <span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span> <span class="fu">str_to_title</span>()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(frequency <span class="sc">&gt;=</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> anxiety<span class="sc">:</span>ocd,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"condition"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genre, condition) <span class="sc">|&gt;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(music_heat, <span class="fu">aes</span>(<span class="at">x =</span> genre, <span class="at">y =</span> condition, <span class="at">fill =</span> mean_score)) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightyellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Mental Health Scores by Genre and Condition"</span>,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Music Genre"</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mental Health Condition"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Avg Score"</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_YilinZhang-_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- Task 3 Tab: Behind the Scenes -  -->
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<ol type="1">
<li><p>One of the biggest challenges I encountered in this analysis was the cleaning and transformation of data. In the original dataset, there are many variable names related to the frequency of music styles that are very complex and repetitive, such as frequency_video_game or frequency_classical. In order to facilitate subsequent analysis and modeling, I have organized it into a more concise and usable form. Although these treatments may not sound particularly special, they form the basis of the entire analysis. Without this step, the subsequent visualization and group summary will be very difficult to carry out efficiently. This process made me realize that clean and tidy data is the prerequisite for high-quality analysis. The preparatory work in the early stage can improve the efficiency of the later work and reduce errors.</p></li>
<li><p>Besides, how to visualize mental health scores in an intuitive, understandable, diverse and interesting way also troubles me. At first, I only knew how to use box plots. But later, I found the report very boring. So I kept exploring and trying different visualization methods, such as violin plots and LOESS smooth curves, etc., to make the trend display clearer and enable the changing trends of four different psychological problems to be presented simultaneously. Although these attempts took a lot of time, they also enabled me to learn more data analysis techniques.</p></li>
<li><p>This is also my first attempt to combine wild data scraping with GitHub to complete the R project. At the beginning, I was very unfamiliar with version control commands and file synchronization. However, through continuous practice, I mastered basic operations such as commit and push, and also learned how to track changes. This has made me understand more profoundly the importance of reputability for data science projects. In the future, in teamwork, these skills learned today can also play an important role.</p></li>
<li><p>To my surprise, some music styles that were originally thought to relieve stress might instead lead to higher scores for anxiety or depression. This made me understand the significance of data analysis. One cannot draw conclusions merely based on subjective judgments. It is necessary to analyze and interpret based on a large amount of data, while also taking into account the protection of the privacy of the subjects and the limitations of the existing data.</p></li>
</ol>
<p>Overall, although the entire analysis process was not always smooth sailing and even involved many repeated failures and attempts, I have gained a lot of growth in data preparation, visualization, and reflective thinking, and have also developed a deeper understanding of “telling a good data story”.</p>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Through this data collation and analysis, it can be seen that preferences for music types and the habit of listening to music may be related to an individual’s mental health outcomes. Although a causal relationship cannot be directly established, it still provides some personal insights for future research directions, music therapy design and personal health strategies. More importantly, this project has taught me technical skills, enabling me to learn to narrate with data and think critically in analysis.</p>
</section>
</div>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>